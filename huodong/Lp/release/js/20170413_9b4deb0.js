require.config(requireConfig),require(["jquery","fastClick","lucky-card","ct","bridge","juicer","marquee"],function(e,t,o,a){var n=(e(".mask"),Object.create(a.Prompt));n.create().build();var s=Object.create(a.Mask);s.create().build();a.Tool.local();a.Tool.buryPoint();var i=((new Date).getDay(),new Image),c=(new Image,["//r.51gjj.com/act/release/img/20170413_alert1.png","//r.51gjj.com/act/release/img/20170413_alert2.png","//r.51gjj.com/act/release/img/20170413_alert3.png"]),l=Math.floor(2*Math.random());i.src=c[l];var r=null,u=null,d=null,p=null,g={status:{login:!1,msg:""},charge:{loan:null,type:null,pay:null},start:function(){var o=this;t.attach(document.body),a.Tool.setFont(),a.Tool.handleBottomStatusBar(),window.addEventListener("resize",a.Tool.debounce(a.Tool.setFont)),window.addEventListener("resize",a.Tool.debounce(a.Tool.handleBottomStatusBar));var n=Object.create(a.PreLodingUi);n.create({preLoadingCls:"loading-bg-color",loadingEleCls:"loading-ele-color"}).build(),a.Tool.imgPreLoad({callback:function(){this.hintLog("图片加载完成");var e=null;clearTimeout(e),e=setTimeout(function(){n.hide(),o.init()},500)}}),e.ajax({type:"POST",dataType:"JSON",url:a.Tool.url("/app/request/activity"),data:JSON.stringify({place_cid:a.Tool.userAgent().isGjj?1:0,tag:"进入页面"+projectName}),success:function(e){1==e.success}})},init:function(){var t=this;e(".wp").removeClass("hide"),t.openRule(),t.closeRule(),t.shakeClick(),t.shake(),t.render(),t.close(),t.apply(),t.applypLot()},render:function(){e.ajax({url:a.Tool.url("/act/act170413/get_status"),type:"POST",dataType:"json",success:function(t){t.ret&&(r=t.ret.url,null!=t.ret.hasPrize&&(d=t.ret.hasPrize),t.ret.type&&(u=t.ret.type)),t.success&&t.ret.hasPrize?(console.log("有奖品"),e(".lot").remove(),e(".status").css("display","block"),e(".mt-mask").removeClass("hide"),e(".status").append("<img class='resultTip' src='//r.51gjj.com/act/release/img/20170413_giftCode"+t.ret.giftCode+".png' /><div class='prizeDetail' bp='chakanjiangpinxiangqing' title='chakanjiangpinxiangqing'></div>"),e(".btn_sub .shake_icon").removeClass("addShake"),console.debug(t.ret.giftCode)):t.ret&&0==t.ret.hasPrize?1==t.ret.type?(e("#imgId").attr("src",i.src),e(".mt-mask").removeClass("hide"),e(".btn_sub .shake_icon").removeClass("addShake"),e(".content .lot").css("display","block")):2==t.ret.type&&(e(".mt-mask").removeClass("hide"),e(".btn_sub .shake_icon").removeClass("addShake"),e(".content .alreadyApply").css("display","block"),e(".content .alreadyApply").on("click",function(){window.location.href=r})):1==t.code&&(n.show(t.msg||"出错请重试"),e(".btn_sub .shake_icon").removeClass("addShake"),e(".btn_sub").unbind(),falg=!1)}})},shakeClick:function(){e(".btn_sub").on("click",function(){e("#imgId").attr("src",i.src),e(".mt-mask").css("display","block"),e(".btn_sub .shake_icon").removeClass("addShake"),e(".content .lot").css("display","block")})},applypLot:function(){e(".lot").on("click",".apply",function(){window.location.href=r})},shake:function(){function t(t){var h=t.accelerationIncludingGravity,k=(new Date).getTime();if(k-l>10){var y=k-l;l=k,o=h.x,n=h.y,s=h.z;var b=Math.abs(o+n+s-d-g-m)/y*1e4;b>c&&(3==u||1==u)&&(e("#imgId").attr("src",i.src),e(".mt-mask").css("display","block"),e(".btn_sub .shake_icon").removeClass("addShake"),e(".content .lot").css("display","block"),e(".lot .apply").on("click",function(){e(".apply").on("click",function(){window.location.href=r})}),p&&(p=!1,e.ajax({type:"POST",dataType:"JSON",url:a.Tool.url("/app/request/activity"),data:JSON.stringify({place_cid:a.Tool.userAgent().isGjj?1:0,tag:"shijinyao"+projectName}),success:function(e){1==e.success}}))),d=o,g=n,m=s}}p=!0,window.DeviceMotionEvent&&window.addEventListener("devicemotion",t,!1);var o,n,s,c=8e3,l=0,d=0,g=0,m=0},changeState:function(e){window.history.pushState&&window.history.pushState({title:e},e,"index.php#page="+e)},openRule:function(){e(".content").on("click",".rule-btn",function(){s.show(),e(".rule").fadeIn()})},closeRule:function(){e("body").on("click",".btn-close",function(){e(".rule").fadeOut(function(){s.hide()})})},close:function(){e("body").on("click",".mt-mask",function(){console.debug(d),console.debug(u),0!=d||1!=u&&3!=u||(e(".lot").css("display","none"),e(".mt-mask").css("display","none"))})},apply:function(){e(".status").on("click",".prizeDetail",function(){console.debug(222),window.location.href=r})}};g.start()});