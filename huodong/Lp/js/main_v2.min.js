function getURLParams(e){var t=e.split("?"),n={};if(t[1]){t[1]=t[1].split("#")[0];for(var o=t[1].split("&"),a=0;a<o.length;++a){var r=o[a].split("="),i=decodeURIComponent(r[0]),c=decodeURIComponent(r[1]);n[i]=c}}return n}var init={fn:function(){this.searchClick(),this.getCode(),this.isInputEnter()},getCode:function(){var e=null,t="g.php",n=this;$(".JS-get-code").on("click",function(){if(n.checkPhone($(".JS-phone"))){var o=$(".JS-phone").val();$.ajax({url:t,type:"POST",dataType:"json",data:{action:"getPhoneCode",phone:o},success:function(t){0==t.errcode?(n.alertBox("短信验证码已发送，请注意查收",2e3),n.timeDown($(".JS-get-code"),60)):512==t.errcode?(n.alertBox("您已注册，点击直接下载",3e3),e=setTimeout(function(){$(".section").addClass("slideTop")},3e3)):($(".JS-get-code").removeClass("timing"),n.alertBox(t.errmsg||"出错了，请重试",2e3))},error:function(e){$(".JS-get-code").removeClass("timing"),n.alertBox("发生错误"+e+"，请重试",2e3)}})}})},searchClick:function(){var e=this,t=null,n="g.php";$(".search-btn").on("click",function(){if(e.checkPhone($(".phone input"))&&e.checkCode($(".msg-code input"))){var o=$(".JS-phone").val(),a=$(".JS-code").val();$.ajax({type:"POST",url:n,dataType:"json",data:{action:$("input.JS-code").length?"register":"lazyRegister",phone:o,code:a,place:getURLParams(window.location.href).channel},success:function(n){0==n.errcode?$(".section").addClass("slideTop"):512==n.errcode?(e.alertBox("您已注册，点击直接下载",3e3),clearTimeout(t),t=setTimeout(function(){$(".section").addClass("slideTop")},3e3)):e.alertBox(n.errmsg||"出错了，请重试",2e3)},error:function(t){e.alertBox("发生错误"+t+"，请重试",2e3)}})}})},checkPhone:function(e){var t=this,n=/^1\d{10}$/,o=e.val();return n.test(o)?!0:void t.alertBox("请输入正确的手机号！",2e3)},checkCode:function(e){var t=this,n=e.val();return""!=n?!0:void t.alertBox("验证码错误或未输入",2e3)},alertBox:function(e,t){var n=null,o=$(".alert-box");clearTimeout(n),0==o.length&&($("body").append($("<div class='alert-box'>"+e+"</div>")),n=setTimeout(function(){$(".alert-box").remove()},t))},timeDown:function(e,t){if(e.hasClass("timing"))return!1;clearInterval(n),e.text(t+"s"),e.addClass("timing"),e.parent().append($("<div class='code-mark'></div>"));var t=t-1,n=setInterval(function(){e.text(t+"s"),t--,0>t&&(clearInterval(n),$(".code-mark").remove(),e.removeClass("timing"),e.text("获取验证码"))},1e3)},isInputEnter:function(){var e=/^1\d{10}$/;$(".JS-code").on("input",function(){var t=$(".JS-phone").val();e.test(t)&&$(".JS-code").val().length>0?$(".search-btn").removeClass("search-btn-not-active").addClass("search-btn-active"):$(".search-btn").removeClass("search-btn-active").addClass("search-btn-not-active")})}};init.fn();