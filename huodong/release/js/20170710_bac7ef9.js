require.config(requireConfig),require(["jquery","fastClick","FullPage","ct","bridge","juicer"],function(e,t,i,s,a){var o=(e(".mask"),Object.create(s.Prompt));o.create().build();var n=Object.create(s.Mask);n.create().build();s.Tool.local();s.Tool.buryPoint();var r={status:{login:!1,weChat:!1,qq:!1,prize:"",oUrl_1:"",oUrl_2:"",type:""},start:function(){var i=this;t.attach(document.body),s.Tool.setFont(),window.addEventListener("resize",s.Tool.debounce(s.Tool.setFont)),window.addEventListener("resize",s.Tool.debounce(s.Tool.handleBottomStatusBar));var a=Object.create(s.PreLodingUi);a.create({preLoadingCls:"loading-bg-color",loadingEleCls:"loading-ele-color"}).build(),s.Tool.imgPreLoad({callback:function(){this.hintLog("图片加载完成");var e=null;clearTimeout(e),e=setTimeout(function(){a.hide(),i.init()},500)}}),e.ajax({type:"POST",dataType:"JSON",url:s.Tool.url("/app/request/activity"),data:JSON.stringify({place_cid:s.Tool.userAgent().isGjj?1:0,tag:"进入页面"+projectName}),success:function(e){1==e.success}})},init:function(){var t=this;e(".wp").removeClass("hide"),t.render(),t.pullDown(),t.receive(),t.skip(),t.openRule(),t.closeRule(),t.share()},render:function(){var t=this;e.ajax({type:"POST",dataType:"JSON",url:"/act/act170710/get_status",success:function(i){i.success?(t.status.login=i.ret.login,t.status.weChat=i.ret.weChat,t.status.qq=i.ret.qq,t.status.oUrl_1=i.ret.url_1,t.status.oUrl_2=i.ret.url_2,t.status.prize=i.ret.prize,1==i.ret.have?(e(".page2").removeClass("hide"),e(".page2 .content").append('<div class="prizeMoney"><img src="http://r.51gjj.com/act/release/img/20170710_prize_'+t.status.prize+'.png"></div>'),o.show("您已领取过红包"),e(".apply").addClass("addShake")):(e(".page1").removeClass("hide"),e(".page1 img").addClass("addFadeIn"),setTimeout(function(){e(".page1").addClass("hide"),e(".page2").removeClass("hide"),e(".page2 .content").append('<div class="prizeMoney"><img src="http://r.51gjj.com/act/release/img/20170710_prize_'+t.status.prize+'.png"></div>'),n.show(),e(".page2").append('<div class="redPackets addMove"><img src="http://r.51gjj.com/act/release/img/20170710_redPackets.png"></div>')},4e3))):(o.show(i.msg||"出错请重试"),e(".page1").unbind())}})},pullDown:function(){var t=this;e(".page2").on("click",".redPackets img",function(){(1==t.status.weChat||1==t.status.qq)&&(o.show("本活动需在app参加"),e(".prize").remove(),e(".mt-mask").css("display","none")),0==t.status.login?a&&a.action("login"):e.ajax({type:"POST",dataType:"JSON",url:"/act/act170710/get_prize",success:function(i){i.success?(t.status.type=i.ret.type,t.status.prize=i.ret.prize,1==i.ret.type?(o.show("您已申请活动业务,暂不符合参与条件,试试其他!"),e(".redPackets").remove(),n.hide()):2==i.ret.type?(o.show(" 您已经参加了该业务的其他优惠活动,不要太贪心哦!"),e(".redPackets").remove(),n.hide()):3==i.ret.type&&(e(".redPackets").remove(),console.log(t.status.prize),e(".page2").append('<div class="prize"><img src="http://r.51gjj.com/act/release/img/20170710_redPackets_'+t.status.prize+'.png"><div class="receive" bp="收下" title="收下"></div></div>'),e(".page2 .content .prizeMoney").remove(),e(".page2 .content").append('<div class="prizeMoney"><img src="http://r.51gjj.com/act/release/img/20170710_prize_'+t.status.prize+'.png"></div>'))):o.show(i.msg||"出错请重试")}})})},receive:function(){e(document).on("click",".receive",function(){e(".prize").remove(),e(".mt-mask").css("display","none"),e(".apply").addClass("addShake")})},skip:function(){var t=this;e(".page2 .looking").on("click",function(){if(1==t.status.weChat||1==t.status.qq){var e=null;clearTimeout(e),e=setTimeout(function(){o.show("在app中参与才能获得奖励哦"),e=setTimeout(function(){window.location.href=t.status.oUrl_1},1500)},200)}else 1==t.status.type?o.show("您已申请活动业务,暂不符合参与条件,试试其他!"):2==t.status.type?o.show(" 您已经参加了该业务的其他优惠活动,不要太贪心哦!"):window.location.href=t.status.oUrl_2}),e(".page2 .apply").on("click",function(){if(1==t.status.weChat){var e=null;clearTimeout(e),e=setTimeout(function(){o.show("在app中参与才能获得奖励哦"),e=setTimeout(function(){window.location.href=t.status.oUrl_1},1500)},200)}else 1==t.status.type?o.show("您已申请活动业务,暂不符合参与条件,试试其他!"):2==t.status.type?o.show(" 您已经参加了该业务的其他优惠活动,不要太贪心哦!"):window.location.href=t.status.oUrl_1})},openRule:function(){e(".content").on("click",".rule-btn",function(){n.show(),e(".rule").fadeIn()})},closeRule:function(){e("body").on("click",".btn-close",function(){e(".rule").fadeOut(function(){n.hide()})})},share:function(){var e=navigator.userAgent,t={mobile:!!e.match(/AppleWebKit.*Mobile.*/),isAndroid:e.indexOf("Android")>-1||e.indexOf("Linux")>-1||e.indexOf("android")>-1,isiOS:/[\w\W]*ios\/[\w\W]+client\/[\w\W]+device\/[\w\W]+theme\/[\w\W]+$/.test(e),webApp:-1==e.indexOf("Safari"),weixin:e.indexOf("MicroMessenger")>-1,isGjj:/^android\/[\w\W]+client\/[\w\W]+theme\/[\w\W]+$/.test(e)||/^[\w\W]*ios\/[\w\W]+client\/[\w\W]+device\/[\w\W]+theme\/[\w\W]+$/.test(e),isAndroidGjj:/^android\/[\w\W]+client\/[\w\W]+theme\/[\w\W]+$/.test(e),isiOSGjj:/^[\w\W]*ios\/[\w\W]+client\/[\w\W]+device\/[\w\W]+theme\/[\w\W]+$/.test(e),isGjjFdjsq:/^android\/[\w\W]+client\/[\w\W]+category\/51fdjsq$/.test(e)},i=window.location.host;return t.isGjj&&a&&a.action("quickIcon",{thumb:"https://r.51gjj.com/image/static/ico_title_share_dark.png",onclick:function(){a.action("ShareTimeline",{title:"7.14银色情人节 这个节日我赞助",desc:"真情红包，真爱相送，点击领取258元现金红包！",thumb:"https://r.51gjj.com/act/release/img/20170710_wxshare.png",link:"http://"+i+"/act/home/huodong/20170710/"})}}),this}};r.start()});