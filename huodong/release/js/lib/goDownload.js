define(["jquery"],function(e){var t={start:function(e){var t=this,e=e;t.goLogin(),t.render(),t.getCode(),t.closeBtn(),t.getLogin(),t.use(e)},goLogin:function(){var t=e("#appAddr");e("#appAddr").on("click",function(){window.location.href="gjj51://",callApp.onElement(t)})},render:function(){var t='<div class="wrap-info"><div class="close-btn"><img src="../static/img/go_close.png"></div><div class="wrap-title">验证手机号码</div>';t+='<div class="user-info"><div class="phone"><input class="JS-phone" type="tel" placeholder="请输入手机号码" maxlength="11"><div class="get-code" bp="获取验证码" title="获取验证码">获取验证码</div></div>',t+='<div class="code"><input type="tel" class="JS-code" placeholder="请输入验证码" maxlength="6"></div></div>',t+='<div class="validate" bp="立即验证" title="立即验证">立即验证</div></div>',e(".mt-mask").removeClass("hide"),e("body").append(t)},closeBtn:function(){e(document).on("click",".close-btn",function(){e(".wrap-info").remove(),e(".mt-mask").addClass("hide")})},getCode:function(){var t=this;e(document).on("click",".get-code",function(){if(t.checkPhone()){var n=e(".JS-phone").val();console.log(n),e.ajax({type:"POST",dataType:"JSON",url:"/act/Currency/get_verification_code",data:JSON.stringify({phone:n}),success:function(n){1==n.success?(t.timeDown(e(".get-code"),60),e(".wrap-title").text("").text(n.msg||"验证码已成功发送！")):512==n.code?(e(".wrap-title").text("").css("font-size","0.28rem"),e(".wrap-title").append("<span>"+n.msg+"</span>"),setTimeout(function(){e(".wrap-info").children().remove();var t='<div class="close-btn"><img src="../static/img/go_close.png"></div><div class="succTip"><img src="../static/img/go_succ_tip.png">验证成功！</div>';t+='<div class="congra">恭喜！您的红包领取成功，申请可立即使用！</div>',t+='<input class="apply" value="立即申请" type="button" bp="立即申请" tiltle="立即申请">',e(".wrap-info").append(t)},1e3)):(e(".wrap-title").children().remove(),e(".wrap-title").text("").append("<span></span>"),e(".wrap-title span").text(n.msg))}})}})},getLogin:function(){var t=this;e(document).on("click",".validate",function(){if(t.checkPhone()&&t.checkCode()){var n=e(".JS-phone").val(),a=e(".JS-code").val();console.log(n,a),e.ajax({type:"POST",dataType:"JSON",url:"/act/Currency/get_register",data:JSON.stringify({phone:n,code:a}),success:function(t){if(t.success){e(".wrap-info").children().remove();var n='<div class="close-btn"><img src="../static/img/go_close.png"></div><div class="succTip"><img src="../static/img/go_succ_tip.png">验证成功！</div>';n+='<div class="congra">恭喜！您的红包领取成功，申请可立即使用！</div>',n+='<input class="apply" value="立即申请" type="button" bp="立即申请" title="立即申请">',e(".wrap-info").append(n)}else e(".wrap-title").text("").css("font-size","0.28rem"),e(".wrap-title").append("<span>"+t.msg+"</span>")}})}})},use:function(t){e(document).on("click",".apply",function(){e.ajax({type:"POST",dataType:"JSON",url:t,success:function(t){t.success?window.location.href=t.ret.url:(e(".succTip").text("").children().remove(),e(".congra").remove(),e(".succTip").append('<div class="wrap-title"><span>'+t.msg+"</span></div>"))}})})},checkPhone:function(){var t=/^1\d{10}$/,n=e(".JS-phone").val();return t.test(n)?(e(".wrap-title").text("").css("font-size","0.35rem").text("验证手机号码"),!0):(console.log("手机号错误"),e(".wrap-title").text("").css("font-size","0.28rem"),e(".wrap-title").text("抱歉，您输入的手机号码或验证码错误，请"),e(".wrap-title").append("<span>重新输入。</span>"),!1)},checkCode:function(){var t=e(".JS-code").val();return""==t?(e(".wrap-title").text("").css("font-size","0.28rem"),e(".wrap-title").text("抱歉，您输入的手机号码或验证码错误，请"),e(".wrap-title").append("<span>重新输入。</span>"),!1):!0},timeDown:function(t,n){if(t.hasClass("timing"))return!1;clearInterval(a),t.text(""),t.append("<span></span>秒后重发"),t.children().text(n),t.addClass("timing"),t.parent().append(e("<div class='code-mark'></div>"));var n=n-1,a=setInterval(function(){t.text(""),t.append("<span></span>秒后重发"),t.children().text(n),n--,0>n&&(clearInterval(a),e(".code-mark").remove(),t.removeClass("timing"),t.text("获取验证码"))},1e3)}},n={start:function(){var t='<div class="bottom-wrap"><a href="gjj51://" id="appAddr">在APP内参与</a></div>';e("body").append(t)}};return{WeChat:t,goApp:n}});