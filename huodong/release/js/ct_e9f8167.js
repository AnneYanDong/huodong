define(["jquery","share"],function(t,e){var i={isObject:function(t){return"[object Object]"==Object.prototype.toString.call(t)},isFunction:function(t){return"[object Function]"==Object.prototype.toString.call(t)},isArray:function(t){return"[object Array]"==Object.prototype.toString.call(t)},isString:function(){return"[object String]"==Object.prototype.toString.call(arr)},isNumber:function(){return"[object Number]"==Object.prototype.toString.call(arr)},isBoolean:function(t){return"[object Boolean]"==Object.prototype.toString.call(t)},isRegExp:function(t){return"[object RegExp]"==Object.prototype.toString.call(t)},extend:function(t){t=t||{};for(var e=1;e<arguments.length;e++)if(arguments[e])for(var i in arguments[e])arguments[e].hasOwnProperty(i)&&(t[i]=arguments[e][i]);return t},debounce:function(t,e,i){var n=null;return i=i||500,e=e||this,function(){clearTimeout(n),n=setTimeout(function(){t.call(e)},i)}},hintLog:function(t){console.log("%c提示："+t,"color: #439ef9")},errLog:function(t){console.log("%c错误："+t,"color: #ea6262")},viewPortInfo:function(){var t,e;return void 0==window.innerWidth?(t=document.documentElement.clientWidth,e=document.documentElement.clientHeight):(t=window.innerWidth,e=window.innerHeight),{w:t,h:e}},trimspace:function(t,e){return t&&this.isString(t)?"left"==e?t.replace(new RegExp("^\\s+"),""):"right"==e?t.replace(new RegExp("\\s+$"),""):t.replace(new RegExp("^\\s+|\\s+$","g"),""):void 0}},n=Object.create(i);n.setFont=function(e){var e=e||7.5,i=this.viewPortInfo();i.w>1024?1024:i.w,t("html")[0].style.fontSize=i.w/e+"px"},n.setFont_v2=function(e){var e=e||7.5,i=this.viewPortInfo();i.w=i.w>640?640:i.w,t("html")[0].style.fontSize=i.w/e+"px"},n.handleBottomStatusBar=function(e){var i=document.getElementsByClassName(e||"content"),n=375,r=603,o=n/r,s=this.viewPortInfo(),a=s.w,c=s.h,l=c*o;if(a-l>10){for(var u=0;u<i.length;u++)i[u].style.height=c+"px",i[u].style.width=l+"px",i[u].style.margin="0 auto";t("html")[0].style.fontSize=l/7.5+"px"}else{for(var u=0;u<i.length;u++)i[u].style.height=c+"px",i[u].style.width=a+"px",i[u].style.margin="0 auto";t("html")[0].style.fontSize=a/7.5+"px"}},n.imgPreLoad=function(e){var i=this,n=[];if(t("img").each(function(e,i){n.push(t(i).data("src"))}),!this.isObject(e))return this.errLog("参数需要传入一个JSON对象，含有图片数组imgArr和加载完成后的回调函数callback"),!1;if(!e.callback||!this.isFunction(e.callback))return this.errLog("需要传入图片加载完成后的回调函数"),!1;var r=e.callback,o=null,s=n.length;if(s>0){for(var a=0,c=function(){s==a&&(clearTimeout(o),t("img").each(function(e,i){i.src=t(this).data("src")}),r.call(i))},l=0;l<n.length;l++){var u=new Image;u.src=n[l],u.onload=u.onerror=function(){a++,i.hintLog("加载完第"+a+"张图片"),c()}}clearTimeout(o),o=setTimeout(function(){s>a&&(a=s,c())},3e3*s)}else r.call(i);return this},n.buryPoint=function(){var e=this;t("body").on("click","[bp]",function(){var i=t(this).attr("bp"),n=e.url(n||"/app/request/activity");u.do({url:n,data:{tag:i+projectName,place_cid:e.userAgent().isGjj?1:0},success:function(){console.log("记录事件："+i)},fail:function(){console.log("记录失败："+i)}})})},n.buryPoint_v2=function(e){var i=this;t("body").on("click","[bp]",function(){var n=t(this).attr("bp"),r=i.url(r||"/act/request/activity");u.do({url:r,data:{tag:n,source:e},success:function(){console.debug("埋点记录成功："+n)},fail:function(){console.debug("埋点记录失败："+n)}})})},n.getUrlData=function(t){var e={},r=window.location.search.slice(1).split("&");return r.forEach(function(t){try{var r=t.split("=");e[r[0]]=r[1]}catch(o){i.errLog.call(n,o)}}),t?e[t]:e},n.userAgent=function(){var t=window.navigator.userAgent,e={mobile:!!t.match(/AppleWebKit.*Mobile.*/),isAndroid:t.indexOf("Android")>-1||t.indexOf("Linux")>-1||t.indexOf("android")>-1,isiOS:/[\w\W]*ios\/[\w\W]+client\/[\w\W]+device\/[\w\W]+theme\/[\w\W]+$/.test(t),webApp:-1==t.indexOf("Safari"),weixin:t.indexOf("MicroMessenger")>-1,isGjj:/^android\/[\w\W]+client\/[\w\W]+theme\/[\w\W]+$/.test(t)||/^[\w\W]*ios\/[\w\W]+client\/[\w\W]+device\/[\w\W]+theme\/[\w\W]+$/.test(t),isAndroidGjj:/^android\/[\w\W]+client\/[\w\W]+theme\/[\w\W]+$/.test(t),isiOSGjj:/^[\w\W]*ios\/[\w\W]+client\/[\w\W]+device\/[\w\W]+theme\/[\w\W]+$/.test(t),isGjjFdjsq:/^android\/[\w\W]+client\/[\w\W]+category\/51fdjsq$/.test(t)};return e},n.local=function(){var t=window.location;return{protocol:t.protocol+"//",host:t.host,origin:t.origin+"/"}},n.appHost=function(){var t=this.local().host,e="";return e=/b.jianbing.com/g.test(t)?"https://b.jianbing.com":/test.jianbing.com/g.test(t)?"https://test.jianbing.com":"https://kaifa.jianbing.com"},n.url=function(t){var e=this.appHost(),i=e+t;return i},n.share=function(i,n){function r(i){e.config({debug:!1,appId:"wx90f7de7c9b73bf69",timestamp:i.timestamp,nonceStr:i.nonceStr,signature:i.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","onMenuShareQZone"]}),e.ready(function(){var n={title:""!=i.title?i.title:t(document).attr("title"),link:""!=i.link?i.link:a,imgUrl:""!=i.image?i.image:c,desc:""!=i.description?i.description:t(document).attr("title"),success:function(){console.log(n.imgUrl)}};e.onMenuShareTimeline(n),e.onMenuShareAppMessage(n),e.onMenuShareQQ(n),e.onMenuShareWeibo(n),e.onMenuShareQZone(n)})}var o=i||0,s=n||"huodong",a=window.location.href.split("#")[0],c="https://r.51gjj.com/image/static/ico_fenx.png";t.ajax({url:"//b.jianbing.com/app/share/share_info",type:"get",data:"url="+encodeURIComponent(a)+"&share_id="+o+"&share_type="+s,dataType:"json",success:function(t){console.log(t),r(t)}})};var r=Object.create(i);r.init=function(){this.ele=null},r.insertDom=function(e){var e=e||t("body");this.ele&&this.ele.appendTo(e)},r.showAnim=function(t,e){var i=this.ele;i.is(":animated")||i.fadeIn(t,e)},r.hideAnim=function(t,e){var i=this.ele;i.is(":animated")||i.fadeOut(t,e)},r.removeEle=function(){this.ele&&this.ele.remove()};var o=Object.create(r);o.timer=null,o.create=function(){return this.init(),this.ele=t(t(".mt-prompt").length>0?".mt-prompt":"<div class='mt-prompt hide'></div>"),this},o.build=function(t){return this.insertDom(t),this},o.show=function(t,e){var i=this;if(t?this.ele.text(t):this.errLog("请输入提示文案"),e&&this.isObject(e)){var n=e.duration,r=e.animClass,o=this.isFunction(e.callback)?e.callback:null;n||(n=2e3),r?(this.ele.removeClass("hide").addClass("anim-conf anim-init"),setTimeout(function(){i.ele.addClass(r)},100),clearTimeout(this.timer),this.timer=setTimeout(function(){i.ele.addClass("hide").removeClass(r),o&&o()},n)):(this.showAnim(),clearTimeout(this.timer),this.timer=setTimeout(function(){i.hideAnim(),o&&o()},n))}else e?this.errLog("Prompt.show()的参数配置错误"):(this.showAnim(),clearTimeout(this.timer),this.timer=setTimeout(function(){i.hideAnim(),o&&o()},2e3));return this};var s=Object.create(r);s.create=function(e){var i=this;if(this.init(),e.txt){e.title=e.title?e.title:"注意";var n=t("<div class='mt-confirm hide'><h6 class='mt-confirm-title'>"+e.title+"</h6><p class='mt-confirm-p'>"+e.txt+"</p></div>")}else this.errLog("没有确认框txt或title");this.ele=n;var r=t("<div class='mt-button-area'></div>");if(r.appendTo(n),e.btnArr&&this.isArray(e.btnArr)){var o=e.btnArr.every(function(t){return i.isObject(t)});if(o){for(var s=e.btnArr.length,a=0;s>a;a++){var c;e.btnArr[a].btnTxt?c=t("<div class='mt-btn'>"+e.btnArr[a].btnTxt+"</div>"):this.errLog("按钮名称未定义"),e.btnArr[a].btnFn?c.on("click",e.btnArr[a].btnFn):this.errLog("未给按钮定义Fn"),e.btnArr[a].btnCls?c.addClass(e.btnArr[a].btnCls):this.hintLog("开发者自己选择是否需要给按钮增加特殊class"),c.appendTo(r)}if(1==s)return;2==s?r.addClass("mt-btn-num-2"):3==s?r.addClass("mt-btn-num-3"):this.errLog("3个按钮还不够你玩？自己写Class吧")}else this.errLog("按钮配置格式错误，请检查是否是[{},{},...]")}else t("<div class='mt-btn'>关闭</div>").appendTo(r).on("click",function(){this.hideAnim(function(){t(".mt-mask").length>0&&t(".mt-mask").hide()})}.bind(this));return this},s.build=function(t){return this.insertDom(t),this},s.show=function(){this.showAnim()};var a=Object.create(r);a.create=function(){return this.init(),this.ele=t(0!=t(".mt-mask").length?".mt-mask":"<div class='mt-mask hide'></div>"),this},a.build=function(t){return this.insertDom(t),this},a.show=function(){return this.ele.show(),this},a.hide=function(){return this.ele.hide(),this},a.customFn=function(t){return t(),this};var c=Object.create(a);c.create=function(e){if(this.init(),0!=t(".mt-ajax-mask").length)this.ele=t(".mt-ajax-mask");else{for(var i=t("<div class='mt-ajax-ele-wrap'></div>"),n=t("<div class='mt-ajax-mask hide'></div>"),r=0;3>r;r++)t("<span>",{"class":"mt-ajax-anim-ball"+(r+1)}).css({backgroundColor:e||"#439df8"}).appendTo(i);i.appendTo(n),this.ele=n}return this},c.anim=function(){return this.ele.find("span").addClass("mt-ajax-anim-conf"),this},c.stopAnim=function(){return this.ele.find("span").removeClass("mt-ajax-anim-conf"),this};var l=Object.create(r);l.create=function(e){this.init();var i=t("<div class='mt-pre-loading'><p class='mt-pre-loading-des'>Waiting For Loading...</p></div>"),n=t("<div class='mt-pre-loading-ele'></div>");return n.appendTo(i),this.ele=i,e&&(i.addClass(e.preLoadingCls),n.addClass(e.loadingEleCls)),this},l.build=function(t){return this.insertDom(t),this},l.hide=function(e){var i=this,e=e||".wrap";return this.hideAnim(300,function(){i.ele.remove(),t(e).show()}),this};var u=Object.create(i);u.createXhrObj=function(){return this.xhr=null,this.xhr=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject,this},u.setConfig=function(t){var e={method:"POST",requestDataType:"string",responseDataType:"JSON",async:!0,data:{},before:function(){},success:function(){},fail:function(){}};return this.config=this.extend({},e,t),this.config.method=this.config.method.toUpperCase(),this.config.requestDataType=this.config.requestDataType.toUpperCase(),this.config.responseDataType=this.config.responseDataType.toUpperCase(),this},u.do=function(t){var e=this;this.createXhrObj(),this.setConfig(t);var i=this.xhr,n=this.config,r=n.data;r="STRING"==n.requestDataType?JSON.stringify(r):this.formateData(r),n.before&&this.isFunction(n.before)&&n.before();var o=(new Date).getTime();"GET"==n.method?(i.open("GET",n.url+"?"+this.formateData(n.data)+"&timestamp="+o,n.async),i.send()):(i.open("POST",n.url+"?timestamp="+o,n.async),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.send(r)),i.onreadystatechange=function(){if(4==i.readyState)if(200==i.status)switch(e.config.responseDataType){case"JSON":var t=JSON.parse(i.responseText);n.success(t);break;case"XML":var t=i.responseXML;n.success(t);break;default:var t=i.responseText;n.success(t)}else n.fail&&n.fail(status)}},u.formateData=function(t){var e=[];for(var i in t){var n=t[i];e.push(i+"="+n)}return e.join("&")};var h=Object.create(i);return h.originCookies=function(){return document.cookie},h.get=function(t){var t=t||{};this.isObject(t)},{Tool:n,Prompt:o,Confirm:s,Mask:a,AjaxMask:c,PreLodingUi:l,Ajax:u}});