require.config(requireConfig),require(["jquery","fastClick","lucky-card","ct","bridge","juicer","marquee"],function(t,e,i,c,o){var n=(t(".mask"),Object.create(c.Prompt));n.create().build();var s=Object.create(c.Mask);s.create().build();c.Tool.local();c.Tool.buryPoint();var a,r,l=(new Date).getDay(),d="//r.51gjj.com/act/release/img/20170406_",u={status:{login:!1,msg:""},charge:{loan:null,type:null,pay:null},start:function(){var i=this;e.attach(document.body),c.Tool.setFont(),c.Tool.handleBottomStatusBar(),window.addEventListener("resize",c.Tool.debounce(c.Tool.setFont)),window.addEventListener("resize",c.Tool.debounce(c.Tool.handleBottomStatusBar));var o=Object.create(c.PreLodingUi);o.create({preLoadingCls:"loading-bg-color",loadingEleCls:"loading-ele-color"}).build(),c.Tool.imgPreLoad({callback:function(){this.hintLog("图片加载完成");var t=null;clearTimeout(t),t=setTimeout(function(){o.hide(),i.init()},500)}}),console.log("..222..");var s=t("#lottery");s[0].style.width=t(".content").width()+"px";{var r=t(".single-info");t(".awards-info")}t.ajax({type:"POST",dataType:"JSON",url:c.Tool.url("/app/request/activity"),data:JSON.stringify({place_cid:c.Tool.userAgent().isGjj?1:0,tag:"进入页面"+projectName}),success:function(t){1==t.success}}),t.ajax({type:"POST",dataType:"JSON",url:c.Tool.url("/act/act170406/get_status"),data:JSON.stringify({action:"status"}),success:function(e){if(a=e.ret.url,1==e.success){if(e.ret.info){for(var c=e.ret.info,o=0;o<c.length;o++){var s=t("<span>");s.text("恭喜："+c[o].name+"抢到"+c[o].money+"元券"),s.appendTo(r)}r.liMarquee({hoverstop:!1,drag:!1,scrollamount:30}),t(".single-info").height(t(".awards-info").height())}}else i.status.msg=e.msg||"出错请重试",n.show(e.msg||"出错请重试")}})},init:function(){var e=this;t(".wp").removeClass("hide"),e.apply(),e.openRule(),e.closeRule(),e.scratch(),e.render(),e.open1(),e.close_apply(),e.close_tip(),e.lookTicket(),e.timeDown(),e.skipLoan()},render:function(){t(".single-info"),t(".awards-info");t.ajax({url:c.Tool.url("/act/act170406/get_status"),type:"POST",dataType:"json",data:JSON.stringify({action:"render"}),success:function(e){if(console.log(1111),1==e.success){var e=e.ret;e.UserTicket&&(1==e.UserTicket?(t("#imgId_200").attr("src",d+"done.png"),s.show(),t(".ticket_50").html("<img src='"+d+"ticket_200.png'><div class='ticket_close'></div><div id='skip'></div>"),t(".ticket_50").fadeIn(),e.$ticketStatus_100?t("#imgId_100").attr("src",d+"doGrey.png"):t("#imgId_100").attr("src",d+"none.png"),e.$ticketStatus_50?t("#imgId_50").attr("src",d+"doGrey.png"):t("#imgId_50").attr("src",d+"none.png")):2==e.UserTicket?(s.show(),t(".ticket_50").html("<img src='"+d+"ticket_100.png'><div class='ticket_close'></div><div id='skip'></div>"),t(".ticket_50").fadeIn(),t("#imgId_100").attr("src",d+"done.png"),e.$ticketStatus_200?t("#imgId_200").attr("src",d+"doGrey.png"):t("#imgId_200").attr("src",d+"none.png"),e.$ticketStatus_50?t("#imgId_50").attr("src",d+"doGrey.png"):t("#imgId_50").attr("src",d+"none.png")):3==e.UserTicket?(s.show(),t(".ticket_50").html("<img src='"+d+"ticket_50.png'><div class='ticket_close'></div><div id='skip'></div>"),t(".ticket_50").fadeIn(),t("#imgId_50").attr("src",d+"done.png"),e.$ticketStatus_200?t("#imgId_200").attr("src",d+"doGrey.png"):t("#imgId_200").attr("src",d+"none.png"),e.$ticketStatus_100?t("#imgId_100").attr("src",d+"doGrey.png"):t("#imgId_100").attr("src",d+"none.png")):(e.$ticketStatus_50?t("#imgId_50").attr("src",d+"do.png"):t("#imgId_50").attr("src",d+"none.png"),e.$ticketStatus_100?t("#imgId_100").attr("src",d+"do.png"):t("#imgId_100").attr("src",d+"none.png"),e.$ticketStatus_200?t("#imgId_200").attr("src",d+"do.png"):t("#imgId_200").attr("src",d+"none.png"))),console.log("44")}else console.log(e.msg||"获取不到中奖信息")},error:function(t){console.log(t)}})},apply:function(){t(".apply1").on("click",function(){var e={type:"1"};console.log("data",JSON.stringify(e)),e=JSON.stringify(e),t.ajax({type:"POST",dataType:"JSON",url:c.Tool.url("/act/act170406/get_url"),data:JSON.stringify({type:1}),success:function(t){1==t.success?window.location.href=t.ret.url:n.show(t.msg||"出错请重试")}})}),t(".apply2").on("click",function(){t.ajax({type:"POST",dataType:"JSON",url:c.Tool.url("/act/act170406/get_url"),data:JSON.stringify({type:2}),success:function(t){1==t.success?window.location.href=t.ret.url:n.show(t.msg||"出错请重试")}})}),t(".apply3").on("click",function(){t.ajax({type:"POST",dataType:"JSON",url:c.Tool.url("/act/act170406/get_url"),data:JSON.stringify({type:3}),success:function(t){1==t.success?window.location.href=t.ret.url:n.show(t.msg||"出错请重试")}})})},changeState:function(t){window.history.pushState&&window.history.pushState({title:t},t,"index.php#page="+t)},openRule:function(){t(".wrap").on("click",".ruleTop",function(){s.show(),t(".rule").fadeIn()})},closeRule:function(){t("body").on("click",".btn-close",function(){t(".rule").fadeOut(function(){s.hide()})})},lookTicket:function(){t(".myTicket").on("click",function(){t(this).data("link");t.ajax({type:"POST",dataType:"JSON",url:c.Tool.url("/act/act170406/get_url"),data:JSON.stringify({type:4}),success:function(t){1==t.success?window.location.href=t.ret.url:n.show(t.msg||"出错请重试")}})})},open1:function(){var e=this;t(".ticket").on("click",function(){var i=t(this).index(),o=i-3;t.ajax({type:"POST",dataType:"json",url:c.Tool.url("/act/act170406/get_rob"),data:JSON.stringify({type:o}),success:function(c){if(1==c.success){var c=c.ret;console.debug("条件",c.allowRob,c.UserTicket),1==c.allowRob&&4===c.UserTicket?(4===i?(s.show(),t(".ticket_50").html("<img src='"+d+"ticket_200.png'><div class='ticket_close'></div><div id='skip'></div>"),t(".ticket_50").fadeIn()):5===i?(s.show(),t(".ticket_50").html("<img src='"+d+"ticket_100.png'><div class='ticket_close'></div><div id='skip'></div>"),t(".ticket_50").fadeIn()):6===i&&(s.show(),t(".ticket_50").html("<img src='"+d+"ticket_50.png'><div class='ticket_close'></div><div id='skip'></div>"),t(".ticket_50").fadeIn()),e.render(),console.debug("index值:"+i)):n.show(c.msg||"出错请重试")}else n.show(c.msg||"出错请重试")}})})},close_apply:function(){t(".ticket_50").on("click","a",function(){t(".ticket_50").fadeOut(function(){s.hide()})})},close_tip:function(){t(".ticket_50").on("click",".ticket_close",function(){t(".ticket_50").fadeOut(function(){s.hide()})})},close1:function(){t(".ticket_50").on("click","a",function(){t(".ticket_50").fadeOut(function(){s.hide()})})},scratch:function(){var e=this,o=t("#start");o.on("click",function(){t.ajax({type:"POST",dataType:"JSON",url:c.Tool.url("/act/act170406/get_shave"),data:JSON.stringify({action:"scratch"}),success:function(c){if(c.success)if(r=c.ret.giftCode,c.ret.allowShave){if(o.remove(),9!=c.ret.giftCode){console.debug("中奖信息：",c.ret.giftCode);var s="<div class='scratchM'><img src='"+d+"scratch_"+c.ret.giftCode+".png'></div>";t("#card").html(s),i.case({ratio:.5,strokes:30,coverImg:"../static/img/20170406_before.png",callback:function(){this.clearCover(),t("#cover").remove()}})}else if(9===c.ret.giftCode){var s="<div class='scratchM'><img src='"+d+"again.png'></div>";t("#card").html(s),i.case({ratio:.5,strokes:30,coverImg:"../static/img/20170406_before.png",callback:function(){this.clearCover(),t("#cover").remove();var i=null;clearTimeout(i),i=setTimeout(function(){t("#scratch").children().remove(),t("#scratch").append("<div id='card' bp='guajiang2' title='guajiang2'></div><div id='start' bp='guajiang1' title='guajiang1'></div>"),e.scratch()},2e3)}})}}else n.show(c.msg||"出错请重试");else{var s="<div class='scratchM'><img src='../static/img/20170406_before.png'></div>";t("#card").html(s),n.show(c.msg||"出错请重试"),console.log("33333")}}})})},skipPage:function(){var e=t("#div1").offset().top;console.log(e),t(document).on("click",".ticket_50",function(){t("body").scrollTop(300),t(".ticket_50").fadeOut(function(){s.hide()})}),t(document).on("click",".scratchM",function(){t("body").scrollTop(e)})},skipLoan:function(){t(".ticket_50").on("click","#skip",function(){console.debug("点击随机跳转"),window.location.href=a}),t(document).on("click",".scratchM",function(){9!=r&&(window.location.href=a)})},share:function(){var t=navigator.userAgent,e={mobile:!!t.match(/AppleWebKit.*Mobile.*/),isAndroid:t.indexOf("Android")>-1||t.indexOf("Linux")>-1||t.indexOf("android")>-1,isiOS:/[\w\W]*ios\/[\w\W]+client\/[\w\W]+device\/[\w\W]+theme\/[\w\W]+$/.test(t),webApp:-1==t.indexOf("Safari"),weixin:t.indexOf("MicroMessenger")>-1,isGjj:/^android\/[\w\W]+client\/[\w\W]+theme\/[\w\W]+$/.test(t)||/^[\w\W]*ios\/[\w\W]+client\/[\w\W]+device\/[\w\W]+theme\/[\w\W]+$/.test(t),isAndroidGjj:/^android\/[\w\W]+client\/[\w\W]+theme\/[\w\W]+$/.test(t),isiOSGjj:/^[\w\W]*ios\/[\w\W]+client\/[\w\W]+device\/[\w\W]+theme\/[\w\W]+$/.test(t),isGjjFdjsq:/^android\/[\w\W]+client\/[\w\W]+category\/51fdjsq$/.test(t)},i=window.location.host;return e.isGjj&&o&&o.action("quickIcon",{thumb:"https://r.51gjj.com/image/static/ico_title_share_dark.png",onclick:function(){o.action("ShareTimeline",{title:"抵息券X元 ",desc:"领券后完成活动页面任一业务申请并放款，还款时可直接抵扣，不可提前还款。【金薪贷】首月还款减免。【金花贷】首月还款减免，100元券借款5000元及以上可用，200元券借款10000元及以上可用。【金盈贷】分月减免，50元券分3个月减免，100元券、200元券分4个月减免。",thumb:"https://r.51gjj.com/act/release/img/20170406_share.png",link:"https://"+i+"/hd/20170406/"})}}),this},timeDown:function(){function e(e){var i=new Array;i[0]=e.getHours(),i[1]=e.getMinutes(),i[2]=e.getSeconds();var c=60*i[0]*60+60*i[1]+i[2],o=86400-c,n=new Array;n[0]=parseInt(o/3600),console.log("小时",n[0]),n[1]=parseInt((o-60*n[0]*60)/60),console.log("分钟",n[1]),n[2]=o-60*n[0]*60-60*n[1],console.log("秒",n[2]),setInterval(function(){n[2]>0?n[2]--:(n[2]=59,n[1]>0?n[1]--:(n[1]=59,n[0]>0?n[0]--:n[0]=23));for(var e=new Array,i=0;3>i;++i)e[i]=String(n[i]),n[i]<10&&(e[i]="0"+e[i]);var c=e[0]+":"+e[1]+":"+e[2];t(".clockTime .nowTime").html(""),t(".clockTime .nowTime").append(c)},1e3)}2===l||3===l?(2===l?(e(new Date),t(".clockTip").text("距离活动开始还有：")):3===l&&t(".clockTip").text("距离活动结束还有："),e(new Date)):(t(".clockTip").text("活动时间为每周三："),t(".nowTime").text("0~24点"))}};u.start()});