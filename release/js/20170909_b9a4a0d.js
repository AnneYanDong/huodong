require.config(requireConfig),require(["jquery","fastClick","FullPage","ct","bridge","juicer","qrcode"],function(e,t,i,r){var s=(e(".mask"),Object.create(r.Prompt));s.create().build();var a=Object.create(r.Mask);a.create().build();var o=(r.Tool.local(),window.location.host,!1);r.Tool.buryPoint_v2(r.Tool.userAgent().isGjj?1:0);var n={start:function(){var i=this;t.attach(document.body),r.Tool.setFont(),window.addEventListener("resize",r.Tool.debounce(r.Tool.setFont));var s=Object.create(r.PreLodingUi);s.create({preLoadingCls:"loading-bg-color",loadingEleCls:"loading-ele-color"}).build(),r.Tool.imgPreLoad({callback:function(){this.hintLog("图片加载完成");var e=null;clearTimeout(e),e=setTimeout(function(){s.hide(),i.init()},500)}}),e.ajax({type:"POST",dataType:"JSON",url:r.Tool.url("/act/request/activity"),data:JSON.stringify({source:r.Tool.userAgent().isGjj?1:0,tag:"20170909_1_0_0_理财抽奖活动"}),success:function(e){1==e.success}})},init:function(){var t=this;e(".wp").removeClass("hide"),t.actStart(),t.render(),t.openRule1(),t.openRule2(),t.closeRule1(),t.closeLottery(),t.closePrize()},getNowFormatDate:function(){var e=new Date,t="-",i=":",r=e.getMonth()+1,s=e.getDate();r>=1&&9>=r&&(r="0"+r),s>=0&&9>=s&&(s="0"+s);var a=e.getHours();a>=0&&9>=a&&(a="0"+a);var o=e.getMinutes();o>=0&&9>=o&&(o="0"+o);var n=e.getSeconds();n>=0&&9>=n&&(n="0"+n);var l=e.getFullYear()+t+r+t+s+" "+a+i+o+i+n;return l},actStart:function(){_this=this;var t=_this.getNowFormatDate();console.log(t),t>="2017-09-15 00:00:00"?(o=!0,_this.pageload(),_this.myPrize(),_this.skip()):(e(".lottery-start").addClass("no-start"),e(".lottery-text").addClass("no-start-text"),e(".lottery-change").remove(),e(".lottery-text").text("暂未开启"),e(".btn-change").addClass("grayscale"),e(".btn-prize").addClass("grayscale"),e(".toPurchase").addClass("grayscale"))},render:function(){e.ajax({type:"POST",url:"/invest2/lottery/QueryLotteryRecord/lotteryTime",dataType:"json",success:function(t){var i=t.resData.lotteryTime;e(".lottery-change span").text(i),0==i?e(".lottery-text").addClass("gray-color"):e(".lottery-text").removeClass("gray-color")}}),e.ajax({type:"POST",url:"/invest2/lottery/QueryLotteryRecord/lottery/totalTenderAmount",dataType:"json",success:function(t){var i=t.resData.totalTenderAmount;console.log(i),e(".btn-tips span").text(i)}})},openRule1:function(){e(".btn-lottery-rule").on("click",function(){a.show(),e(".rule-1").fadeIn()})},openRule2:function(){e(".btn-rule-2").on("click",function(){a.show(),e(".rule-2").fadeIn()})},closeRule1:function(){e("body").on("click",".btn-close",function(){e(".rule").fadeOut(function(){a.hide()})})},closeLottery:function(){e(".prize-box-lottery").on("click",".btn-close",function(){e(this).parent().addClass("hide"),e(".mask").addClass("hide")})},pageload:function(){function t(){return a.times+=1,a.roll(),a.times>a.cycle+10&&a.prize==a.index?(clearTimeout(a.timer),r.removeClass("hide"),setTimeout(function(){switch(a.prize){case 0:e(".prize-box-0").removeClass("hide");break;case 1:e(".prize-box-1").removeClass("hide");break;case 2:e(".prize-box-2").removeClass("hide");break;case 3:e(".prize-box-3").removeClass("hide");break;case 4:e(".prize-box-4").removeClass("hide");break;case 5:e(".prize-box-5").removeClass("hide");break;case 6:e(".prize-box-6").removeClass("hide");break;case 7:e(".prize-box-7").removeClass("hide")}a.prize=-1,a.times=0,o=!1},250)):(a.times<a.cycle?a.speed-=10:a.times==a.cycle||(a.speed+=a.times>a.cycle+10&&(0==a.prize&&7==a.index||a.prize==a.index+1)?110:20),a.speed<40&&(a.speed=40),a.timer=setTimeout(t,a.speed)),!1}var i=this,r=e(".mask"),a=(e(".no-chance"),{index:0,count:0,timer:0,speed:20,times:0,cycle:50,prize:-1,init:function(t){e("#"+t).find(".lottery-box").length>0&&($lottery=e("#"+t),$units=$lottery.find(".lottery-box"),this.obj=$lottery,this.count=$units.length,$lottery.find(".lottery-box-"+this.index).addClass("lottery-active"))},roll:function(){var t=this.index,i=this.count,r=this.obj;return e(r).find(".lottery-box-"+t).removeClass("lottery-active"),t+=1,t>i-1&&(t=0),e(r).find(".lottery-box-"+t).addClass("lottery-active"),this.index=t,!1},stop:function(e){return this.prize=e,!1}}),o=!1;a.init("lottery"),e(".lottery-start").click(function(){return o?!1:void e.ajax({url:"/invest2/lottery/QueryLotteryRecord/lottery",type:"POST",dataType:"json",success:function(e){if(1==e.resCode){var r=e.resData.type,n=null;switch(r){case"1":n=1;break;case"2":n=7;break;case"3":n=3;break;case"4":n=6;break;case"5":n=0;break;case"6":n=2;break;case"7":n=4;break;case"8":n=5}return a.stop(n),console.log("****,",n),i.render(),a.speed=100,t(),o=!0,!1}s.show("Token不存在"==e.resMsg?"请先登录哦~":e.resMsg||"出错，请重试")},error:function(e){s.show(e)}})})},myPrize:function(){e(".wrap-button").on("click",".btn-prize",function(){e(".mask").removeClass("hide"),e(".prize-list").removeClass("hide"),e.ajax({type:"POST",url:"/invest2/lottery/QueryLotteryRecord/lotteryRecord",dataType:"json",success:function(t){if(0!=t.resData.list.length){var i='<div class="has-prize"><div class="prize-icon"><img src="//r.51gjj.com/act/release/img/20170909_prize_list_'+t.resData.list[0].type+'.png"></div></div>';e(".has-prize").length<=0&&(console.log(e(".prize-list").length),e(".prize-list").append(i)),1==t.resData.list[0].type?e(".has-prize").append('<div class="prize-text">iphone8(32G)</div>'):2==t.resData.list[0].type?e(".has-prize").append('<div class="prize-text">500元京东卡</div>'):3==t.resData.list[0].type?e(".has-prize").append('<div class="prize-text">小米手环</div>'):4==t.resData.list[0].type?e(".has-prize").append('<div class="prize-text">小米充电宝</div>'):5==t.resData.list[0].type?e(".has-prize").append('<div class="prize-text">50元京东卡</div>'):6==t.resData.list[0].type?e(".has-prize").append('<div class="prize-text">爱奇艺月卡</div>'):7==t.resData.list[0].type&&e(".has-prize").append('<div class="prize-text">5元现金</div>')}else{var i='<div class="wrap-no-prize"><div class="no-prize-img"></div><div class="null-text">还是空的，快去抽奖吧！</div></div>';e(".prize-list").append(i)}}})})},closePrize:function(){e(".prize-list").on("click",".btn-prize-conf",function(){e(".mask").addClass("hide"),e(".prize-list").addClass("hide"),e(".has-prize")&&e(".has-prize").remove(),e(".wrap-no-prize")&&e(".wrap-no-prize").remove()})},skip:function(){e(".wrap-button").on("click",".btn-change",function(){window.location.href="javascript:history.go(-1);"}),e(".toPurchase").on("click",function(){window.location.href="javascript:history.go(-1);"})}};n.start()});