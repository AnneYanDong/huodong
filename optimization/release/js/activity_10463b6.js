var init={actCenter:function(){window.centerVm=new Vue({el:"#app",data:{menu:["活动","红包/奖品"],menuActive:0,bannerTimer:null,bannerList:[],hotList:[],recommendList:[],actType:[],prizeList:[],prizeRecord:[],showRecord:!1,recordPid:1,recordText:"",showMore:!1,prizeShow:!1,singlePrize:{},ajaxStatus:!0,maskStatus:!1},filters:{dateLineDes:function(t,i){return 1===i?t:t}},computed:{recordTextChange:function(){return this.showRecord?"历史记录":"查看历史记录"}},created:function(){var t=ct.getUrlData("defaultmenu")+"";this.menuActive="0"==t?0:1},mounted:function(){this.render()},methods:{tab1:function(){this.menuChange(0),this.closePrizeForm()},tab2:function(){this.menuChange(1)},render:function(){function t(){return axios.post(ct.packingUrl("/app/banners/get_activity_banners"),JSON.stringify({}))}function i(){return axios.post(ct.packingUrl("/act/v2/activities/get_act_categories"),JSON.stringify({location:"activity_hot"}))}function e(){return axios.post(ct.packingUrl("/act/v2/activities/get_gifts"),JSON.stringify({}))}function n(){return axios.post(ct.packingUrl("/act/v2/activities/record_gifts"),JSON.stringify({pid:o.recordPid}))}var o=this;axios.all([t(),i(),e(),n()]).then(axios.spread(function(t,i,e,n){o.ajaxStatus=!1;var t=t.data,i=i.data,e=e.data,n=n.data;t.success&&(o.bannerList=t.ret.activity_shuffling,o.hotList=t.ret.activity_hot,o.recommendList=t.ret.others?t.ret.others:null,o.$nextTick(function(){o.tabShow()})),i.success&&(console.log("actType"),o.actType=i.ret),e.success&&(console.log("prizeList"),o.prizeList=e.ret)}))},renderGetPrize:function(){function t(){return axios.post(ct.packingUrl("/act/v2/activities/get_gifts"),JSON.stringify({}))}function i(){return axios.post(ct.packingUrl("/act/v2/activities/record_gifts"),JSON.stringify({}))}var e=this;console.log("renderGetPrize"),axios.all([t(),i()]).then(axios.spread(function(t,i){var t=t.data,i=i.data;t.success&&(e.prizeList=t.ret),i.success&&(e.prizeRecord=i.ret)}))},tabShow:function(){clearTimeout(this.bannerTimer),this.bannerTimer=setTimeout(function(){$(".banner-pic").swipeSlide({continuousScroll:!0,speed:3e3,transitionType:"cubic-bezier(0.22, 0.69, 0.72, 0.88)",firstCallback:function(t,i,e){e.find(".banner-nav").children().first().addClass("active")},callback:function(t,i,e){e.find(".banner-nav").children().eq(t).addClass("active").siblings().removeClass("active")}})},100)},menuChange:function(t){console.log(t),0==t?(this.tabShow(),this.menuActive=0,this.showRecord=!1):this.menuActive=1},goList:function(t){if(t)var i=ct.packingUrl("/act/home/optimization/activity/ActList.php?id="+t);window.location.href=i},goDetail:function(t){console.log("..."),window.location.href=t},openPrizeForm:function(t){var i=this,e=t.button.confirmInfoType;return this.singlePrize=t,5===e?void console.log("type=5不能点，也没提示"):void(0===e?window.location.href=t.button.url:4===e?axios.post(ct.packingUrl("/act/v2/activities/receive_gift"),JSON.stringify({aid:t.aid,gid:t.gid,sid:t.id})).then(function(t){t.data.success&&(ct.prompt({txt:"我的文案"}),i.renderGetPrize())}):(this.prizeShow=!0,this.maskStatus=!0,console.log(this.$refs.childPrizeForm),this.$refs.childPrizeForm.getUserInfo()))},closePrizeForm:function(){console.log("触发关闭奖品框事件"),this.prizeShow=!1,this.maskStatus=!1},dropload:function(){var t=this,i=$(".prize-record-drop-wrap").dropload({scrollArea:window,loadDownFn:function(e){t.showRecord&&axios.post(ct.packingUrl("/act/v2/activities/record_gifts"),JSON.stringify({pid:t.recordPid})).then(function(n){if(n.data.success){t.recordPid++;var o=n.data.ret;if(o.length>0)for(var a=0;a<o.length;a++)t.prizeRecord.push(o[a]);else console.log("no data"),i.lock("down"),i.noData();e.resetload()}})}})},back:function(){alert("go-1"),window.history.go(-1)}},watch:{showRecord:function(){var t=this;if(this.showRecord){var i=null;clearTimeout(i),i=setTimeout(function(){t.dropload()},100)}}}})},actList:function(){window.listVm=new Vue({el:"#app",data:{actList:[],actListPid:1,ajaxStatus:!0},mounted:function(){this.render()},methods:{render:function(){var t=this,i=ct.getUrlData("id");axios.post(ct.packingUrl("/act/v2/activities/act_category_list"),JSON.stringify({category_id:i,pid:t.actListPid})).then(function(e){if(e.data.success){t.ajaxStatus=!1,t.actList=e.data.ret,t.actListPid++;var n=$(".act-list-wrap").dropload({scrollArea:window,loadDownFn:function(e){axios.post(ct.packingUrl("/act/v2/activities/act_category_list"),JSON.stringify({category_id:i,pid:t.actListPid})).then(function(i){if(i.data.success){t.actListPid++;var o=i.data.ret;if(o.length>0)for(var a=0;a<o.length;a++)t.actList.push(o[a]);else console.log("no data"),n.lock("down"),n.noData();e.resetload()}})}})}})}}})},prizeDetail:function(){window.detailVm=new Vue({el:"#app",data:{detailInfo:"",prizeBanner:{type:Array,"default":[]},buttonInfo:"",shippingInfo:"",prizeShow:!1,singlePrize:{},ajaxStatus:!0,maskStatus:!1},created:function(){this.render()},mounted:function(){},methods:{render:function(){function t(){return axios.post(ct.packingUrl("/act/v2/activities/get_gift"),JSON.stringify({gid:o,aid:a,sid:r}))}function i(){return s?axios.post(ct.packingUrl("/act/v2/activities/get_record_button "),JSON.stringify({sid:r})):axios.post(ct.packingUrl("/act/v2/activities/get_button"),JSON.stringify({sid:r}))}function e(){return axios.post(ct.packingUrl("/act/v2/activities/get_shipping"),JSON.stringify({sid:r}))}var n=this,o=ct.getUrlData("gid"),a=ct.getUrlData("aid"),r=ct.getUrlData("sid"),s=ct.getUrlData("is_valid");axios.all([t(),i(),e()]).then(axios.spread(function(t,i,e){var t=t.data,i=i.data,e=e.data;n.ajaxStatus=!1,t.success&&(n.detailInfo=t.ret,n.detailInfo.imgList?(n.prizeBanner=t.ret.imgList,n.$nextTick(function(){n.detailInfo.imgList.length>1&&n.tabShow()})):ct.prompt({txt:"产品图片没有配置"})),i.success&&(n.buttonInfo=i.ret),e.success&&(n.shippingInfo=e.ret),n.singlePrize={id:r,gid:o,aid:a,confirmInfoType:i.ret.confirmInfoType}}))},tabShow:function(){setTimeout(function(){$(".banner-pic").swipeSlide({continuousScroll:!0,speed:3e3,transitionType:"cubic-bezier(0.22, 0.69, 0.72, 0.88)",firstCallback:function(t,i,e){e.find(".banner-nav").children().first().addClass("active")},callback:function(t,i,e){e.find(".banner-nav").children().eq(t).addClass("active").siblings().removeClass("active")}})},100)},openPrizeForm:function(){var t=this;if(!this.buttonInfo.confirmInfoType.toString())return ct.prompt({txt:"出错,按钮状态参数没有"}),!1;var i=this.buttonInfo.confirmInfoType;return 5===i||9===i?void console.log("不能点，也没提示"):void(0===i?window.location.href=t.buttonInfo.url:4===i?axios.post(ct.packingUrl("/act/v2/activities/receive_gift"),JSON.stringify({aid:t.singlePrize.aid,gid:t.singlePrize.gid,sid:t.singlePrize.id})).then(function(t){t.data.success&&ct.prompt({txt:"我的文案"})}):(this.prizeShow=!0,this.maskStatus=!0,this.$refs.childPrizeForm.getUserInfo()))},closePrizeForm:function(){console.log("触发关闭奖品框事件"),this.prizeShow=!1,this.maskStatus=!1}},filters:{from:function(t){return"来源："+t}},computed:{detailinfoTxt:function(){function t(t){var i=/(<br\/>|<br>|<BR>|<BR\/>)/g,e=t.replace(i,"\n");return e}var i=this.detailInfo.prizeDes;return i&&(i=t(i)),i},buttonStatus:function(){var t,i=this.buttonInfo.confirmInfoType;return t=9===i||-1===i?"bg-grey font-grey":"bg-blue"}}})}};Vue.component("prize-form",{template:"#getForm",props:{prizeShow:Boolean,singlePrize:Object},data:function(){return{userInfo:{got:!1,name:"",phone:"",alipay:"",address:""}}},mounted:function(){},methods:{closeparentprizeform:function(){this.$emit("closeparentprizeform"),this.userInfo.got=!1},getUserInfo:function(){var t=this;this.$nextTick(function(){axios.post(ct.packingUrl("/act/v2/activities/get_user_info"),JSON.stringify({sid:t.singlePrize.id})).then(function(i){var i=i.data;t.userInfo.got=!0,i.success&&(t.userInfo.name=i.ret.name||"",t.userInfo.phone=i.ret.phone||"",t.userInfo.address=i.ret.address||"",t.userInfo.alipay=i.ret.alipay||"")})})},gotrender:function(){var t=this;console.log("触发领取事件"),axios.post(ct.packingUrl("/act/v2/activities/receive_gift"),JSON.stringify({aid:t.singlePrize.aid,gid:t.singlePrize.gid,sid:t.singlePrize.id,name:t.userInfo.name,phone:t.userInfo.phone,alipay:t.userInfo.alipay,address:t.userInfo.address})).then(function(i){i.data.success?(t.closeparentprizeform(),ct.prompt({txt:i.data.msg||"领取奖品成功",duration:3e3}),t.$emit("gotrender")):ct.prompt({txt:i.data.msg,duration:3e3})})}}}),Vue.component("loading-anim",{template:"#loadingAnim",props:{ajaxStatus:Boolean}}),Vue.component("my-mask",{template:"#oMask",props:{maskStatus:Boolean}});